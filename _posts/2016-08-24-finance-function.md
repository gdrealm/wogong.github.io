---
title: 日常财务计算
date: 2016-08-24
update: 2016-11-02
---

本文介绍日常财务计算知识。

## Excel 财务函数
1. 基本概念
	* Rate 利率
	* Nper 年金的付款总期数
	* PV 现值
	* FV 终值
	* PMT 年金（Payment），每期支付金额（含本金与利息）
2. 函数
	* PV 等额年金求现值，返回投资的现值。 现值是一系列未来支出现在所值的总额。
	* FV 等额年金求终值。基于固定利率和等额分期付款方式，返回某项投资的未来值。
	* NPV 不规则年金求现值。使用贴现率和一系列未来支出（负值）和收益（正值）来计算一项投资的净现值。
	* PMT 求年金。根据固定付款额和固定利率计算贷款的付款额。
	* Rate 返回年金每期的利率。
	* IRR 返回由值中的数字表示的一系列现金流的内部收益率。 这些现金流不必等同，因为它们可能作为年金。 但是，现金流必须定期（如每月或每年）出现。 内部收益率是针对包含付款（负值）和收入（正值）的定期投资收到的利率。

## 日常使用场景
1. 信用卡分期付款对应年利率？
以浦发银行账单分期为例，3期手续费2.64%，假设分期金额3000，则每期应付金额
为（1000+26.4）。计算其名义年利率: 12\*Rate(3,-1026.4,3000)=15.77%.
简便算法: 22\*2.64%/3 = 19.36%.

2. 12期免息分期付款到底有多优惠？
主要考虑自己的折现率，这里 Rate 取 10%。假设商品的总价C。
计算现值
	PV(10%/12, 12, C/12)
对应到折扣为
	PV(10%/12, 12, C/12) / C
通过计算可知，折现率取 10% 时，对应的折扣大约是 0.95, 即相当于 95 折。

3. 贷款 50 万元，年利率 6.75%，期限 5 年，每月等额本息还款，每月要还多少？
	pmt(6.75%/12, 60, 500000)=-9841.73 CNY

4. 贷款50万元，期限5年，每月等额本息还还款10000元，年利率是多少？ 
	rate(60,-10000,500000)*12=7.42% 

5. 投资10万元，年利率15%，每月计算复利，2年后是多少？ 
	fv(15%/12,24,0,-100000)=134735.11  CNY

6. 投资一笔钱，年利率15%，每月计算复利，2年后是14万元，问当初投了多少？ 
	pv(15%/12,24,0,140000)=-103907.59 CNY

7. 投资10万元，年利率15%，每月计算复利，每个月追加投入2000元，2年后是多少？ 
	fv(15%/12,24,-2000,-100000)=190311.27  CNY

8. 投资一笔钱，年利率15%，每月计算复利，每个月追加投入2000元，2年后是14万元，问当初投了多少？ 
	pv(15%/12,24,-2000,140000)=-62659.12 

## 注意
1. 还有一个nper的函数，不过实用意义不大，故未举例。 
2. 注意pv/fv/pmt这3个数值的正负数问题。可以这样记忆，以自己为中心，钱流入（进自己钱包）为正，钱流出（从自己钱包出来）为负。比如向银行贷款了100万进自己钱包，为+100万；投资了10万元出去，为-10万；每月还款8000元，为-8000；等等。 
3. 注意月利率与年利率之间有个12倍关系，同一个公式里面，要统一用月利率或者统一用年利率，一定要统一。 
4. 另外还有irr和xirr这两个函数尤其是xirr也较常用，具体用法请自己度娘，这里不再赘述。 
5. 关于利率的问题，无论多么复杂，实际都是一个一元多次方程的求解问题，可以利用excel表的VBA功能迅速求解，或者利用其他数据软件工具也可以方便求解。 

## 参考
1. [一些基础财务函数 #2370][1]
2. 微信群转载，多谢不知名兄


[1]:	http://mp.weixin.qq.com/s?__biz=MzAxNTMxMTc0MA==&mid=2651014937&idx=1&sn=ccbd030c023bcc25fbfd26b6196a8877&scene=0#rd