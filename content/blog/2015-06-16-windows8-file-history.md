---
layout: post
title: Windows 8 系统使用文件历史功能
tags: windows
descreption: 
create: 2015-06-16
update: 2015-06-16
---

一直是 Windows 的用户，Linux 的桌面尝试的时间不太长，毕竟作为一名工科搬砖苦力不可能在 PC 上使用 Linux 桌面再装个虚拟机开 Windows 做计算，其实还是 Linux 桌面实在太无法忍受。基本没有用过 Mac OS，想着有机会可以买一台当作娱乐折腾本，可惜从去年开始吐槽 Mac OS 的言论日益增多，此种想法略受影响。如此种种暂且不说。好久没有更新，且在这里总结一下 Windows 系统的个人使用姿势，关于文件历史功能。

熟悉 Mac OS X 的用户应该了解 Time Machine (TM)，不知我身边的 Mac 用户有多少人使用了这个功能。在没有听到各种吐槽之前不得不说 TM 给人的感觉真是逆天，后来在考虑 Linux 系统备份问题的时候，想到 TM 实现的可能性便在于其是 Unix 系统。Windows 系统遇到问题如何解决呢？重启，不行再重装，如此应该可以应付绝大多数的问题。重启浪费的只是几分钟时间，然而，重装系统浪费的就是数小时的时间，还有甚至数月时间的不方便。即使自认为是 Windows 老鸟，我也尽量不去重装系统，实在是不想浪费时间。好在Windows 也没有那么脆弱，略微注意使用习惯，设置好系统还原类似等等，遏止住想要折腾骚动不安的内心用个几年不重装是没问题的。今天的主题是备份，Windows 有个全盘备份的功能，个人没有使用的原因在于系统盘太大，没有空间和时间来进行一次全盘备份。但是如何保证数据的安全呢？在网络不便的情况下完全依靠云是极度不可靠的。引出今天的主角，Windows 8 的文件历史功能。

File History 即文件历史功能，需要配合库来使用，所以需要将希望进行文件历史记录的默认对全部库文件夹开启文件历史功能，但是对于音乐、图片与视频库显然没有必要，可以在设置里面去除这些库。使用库来进行管理显得略奇怪，但是由于个人不是库的重度用户，所以无甚不便。

文件历史记录位置可以为网络位置、外置硬盘和无系统文件的内置硬盘。前两者比较容易理解，对于第三者的系统文件包括例如分页文件、休眠文件、其他系统文件，以及 Windows 的库位置。因为设计要求，包含这些文件的硬盘分区无法用作历史记录的备份位置。

在没有网络存储设备，例如 NAS 的情况下，长时接着移动硬盘显然不太现实。那么如何利用内置硬盘进行文件历史记录呢？可以借助于虚拟硬盘 VHD 技术或者共享文件夹方法。
因为SSD据说寿命和稳定性不如机械硬盘，所以拿Windows自带的File History做了一个备份。File History就像是Mac的Time Machine，是Win 8新引入的特性，支持多版本全自动备份。然而File History默认只能在外部磁盘和网络磁盘上开启，即使是像我这样的双硬盘也没法选择从一块硬盘备份到另外一块上。网上搜索了一下，大概有两种解决办法：

1. VHD挂载。VHD有点像虚拟机的磁盘文件，可以挂载到真实的系统中。更猛的是这玩意系统底层支持相当不错，上面甚至可以安装系统（当然是通过Windows的引导程序才行），可以说和真正的磁盘相差无几。

>按下 Win + R 快捷键组合，在弹出的运行对话框中输入 diskmgmt.msc，按下回车启动“磁盘管理”。

>选择“操作”菜单中的“创建 VHD”选项，VHD 文件是一种虚拟磁盘文件格式，Windows 8 将被安装到该文件中，因此无需特别的分区。在对话框中设置 VHD 文件路径和大小，推荐大小至少为 20 GB。为提高性能，建议选择“固定大小”。

>设置完毕，点击“确定”即可。Windows 将开始创建 VHD 文件。

>VHD 创建完毕之后，在下方的磁盘列表就可以看到该虚拟磁盘了，右键点击该虚拟磁盘，选择“初始化磁盘”。

2. 共享文件夹。随便建立一个文件夹，并把它共享给自己，这样这个文件夹就变成了一个网络文件夹，在File History里添加网络磁盘即可。这样系统访问的时候相当于从localhost上绕了一圈。我用的是这个方法，原因是第一种方法的磁盘要写个脚本丢到startup里去才能开机自动挂载。

Windows使用了这么多年，依旧能发现新鲜的东西。利用虚拟硬盘当作文件历史记录盘，避免了使用外置盘的不便。当然以后重装系统还是需要拆下机械硬盘，系统装好后插上机械硬盘当作数据盘。这样就不用迂回路线了。PC 使用 SSD 系统盘加大容量 HDD 数据盘应该是兼顾速度与容量的最佳方案了。（上午使用 VIM 写了很多，以为保存了，结果下午才发现移动文件之后的修改全部丢失，补了一些，但还是丢失了不少内容，难得写一篇还遇到这种事情影响心情，所以我心安理得的去折腾  VIM 的自动保存了。）
